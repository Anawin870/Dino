<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เกมไดโนเสาร์กระโดดข้ามกระบองเพชร</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background-color: #f7f7f7;
            overflow: hidden;
            user-select: none;
        }
        
        #game-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 300px;
            margin: 50px auto;
            background-color: #fff;
            border: 1px solid #ddd;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        #ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 20px;
            background-color: #333;
        }
        
        #dino {
            position: absolute;
            width: 60px;
            height: 80px;
            bottom: 20px;
            left: 50px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 80"><path d="M20,80 L40,80 L50,60 L40,40 L30,20 L20,40 L10,60 Z" fill="%23555"/><circle cx="35" cy="30" r="5" fill="%23000"/></svg>');
            background-repeat: no-repeat;
            transition: transform 0.1s;
        }
        
        .cactus {
            position: absolute;
            width: 30px;
            height: 60px;
            bottom: 20px;
            right: -30px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 60"><path d="M10,60 L20,60 L25,40 L20,20 L15,0 L10,20 L5,40 Z" fill="%232e8b57"/></svg>');
            background-repeat: no-repeat;
        }
        
        #score-display {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 24px;
            color: #333;
        }
        
        #high-score-display {
            position: absolute;
            top: 40px;
            right: 20px;
            font-size: 16px;
            color: #666;
        }
        
        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: bold;
            color: #ff3333;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: none;
        }
        
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255,255,255,0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        #start-title {
            font-size: 36px;
            margin-bottom: 20px;
            color: #333;
        }
        
        #start-button {
            padding: 10px 20px;
            font-size: 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #start-button:hover {
            background-color: #45a049;
        }
        
        #instructions {
            margin-top: 20px;
            font-size: 16px;
            color: #666;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="ground"></div>
        <div id="dino"></div>
        <div id="score-display">0</div>
        <div id="high-score-display">คะแนนสูงสุด: 0</div>
        <div id="game-over">GAME OVER</div>
        
        <div id="start-screen">
            <div id="start-title">เกมไดโนเสาร์กระโดดข้ามกระบองเพชร</div>
            <button id="start-button">เริ่มเกม</button>
            <div id="instructions">กด Spacebar เพื่อกระโดด</div>
        </div>
    </div>

    <script>
        // ตัวแปรเกม
        const dino = document.getElementById('dino');
        const gameContainer = document.getElementById('game-container');
        const scoreDisplay = document.getElementById('score-display');
        const highScoreDisplay = document.getElementById('high-score-display');
        const gameOverDisplay = document.getElementById('game-over');
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        
        let isJumping = false;
        let isGameOver = false;
        let isGameStarted = false;
        let score = 0;
        let highScore = localStorage.getItem('dinoHighScore') || 0;
        let gameSpeed = 5;
        let cacti = [];
        let animationFrameId;
        let lastCactusTime = 0;
        
        // อัพเดตคะแนนสูงสุด
        highScoreDisplay.textContent = `คะแนนสูงสุด: ${highScore}`;
        
        // ฟังก์ชันกระโดด
        function jump() {
            if (isJumping || !isGameStarted) return;
            
            isJumping = true;
            let jumpHeight = 0;
            const jumpSpeed = 8;
            const gravity = 0.5;
            let velocity = jumpSpeed;
            
            function jumpAnimation() {
                jumpHeight += velocity;
                velocity -= gravity;
                
                if (jumpHeight <= 0) {
                    jumpHeight = 0;
                    isJumping = false;
                    return;
                }
                
                dino.style.bottom = (20 + jumpHeight) + 'px';
                animationFrameId = requestAnimationFrame(jumpAnimation);
            }
            
            cancelAnimationFrame(animationFrameId);
            jumpAnimation();
            
            // เพิ่มเอฟเฟกต์กระโดด
            dino.style.transform = 'scale(1.1, 0.9)';
            setTimeout(() => {
                dino.style.transform = 'scale(1, 1)';
            }, 200);
        }
        
        // สร้างกระบองเพชร
        function createCactus() {
            const now = Date.now();
            if (now - lastCactusTime < 1500 && Math.random() > 0.3) return;
            lastCactusTime = now;
            
            const cactus = document.createElement('div');
            cactus.className = 'cactus';
            
            // ความสูงสุ่มของกระบองเพชร
            const height = 40 + Math.random() * 40;
            cactus.style.height = height + 'px';
            cactus.style.bottom = '20px';
            
            gameContainer.appendChild(cactus);
            cacti.push({
                element: cactus,
                x: gameContainer.offsetWidth,
                width: 30,
                height: height
            });
        }
        
        // อัพเดตเกม
        function updateGame() {
            if (!isGameStarted || isGameOver) return;
            
            // เคลื่อนไหวกระบองเพชร
            for (let i = cacti.length - 1; i >= 0; i--) {
                const cactus = cacti[i];
                cactus.x -= gameSpeed;
                cactus.element.style.right = (gameContainer.offsetWidth - cactus.x) + 'px';
                
                // ตรวจสอบการชน
                const dinoRect = {
                    x: 50,
                    y: parseFloat(dino.style.bottom) || 20,
                    width: 60,
                    height: 80
                };
                
                const cactusRect = {
                    x: cactus.x,
                    y: gameContainer.offsetHeight - cactus.height - 20,
                    width: cactus.width,
                    height: cactus.height
                };
                
                if (isColliding(dinoRect, cactusRect)) {
                    gameOver();
                    return;
                }
                
                // ลบกระบองเพชรที่ออกจากหน้าจอ
                if (cactus.x + cactus.width < 0) {
                    gameContainer.removeChild(cactus.element);
                    cacti.splice(i, 1);
                    score++;
                    scoreDisplay.textContent = score;
                    
                    // เพิ่มความเร็วทุก 10 คะแนน
                    if (score % 10 === 0) {
                        gameSpeed += 0.5;
                    }
                }
            }
            
            // สร้างกระบองเพชรใหม่
            createCactus();
            
            // ดำเนินเกมต่อ
            if (!isGameOver) {
                requestAnimationFrame(updateGame);
            }
        }
        
        // ตรวจสอบการชน
        function isColliding(rect1, rect2) {
            return (
                rect1.x < rect2.x + rect2.width &&
                rect1.x + rect1.width > rect2.x &&
                rect1.y < rect2.y + rect2.height &&
                rect1.y + rect1.height > rect2.y
            );
        }
        
        // จบเกม
        function gameOver() {
            isGameOver = true;
            gameOverDisplay.style.display = 'block';
            
            // อัพเดตคะแนนสูงสุด
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('dinoHighScore', highScore);
                highScoreDisplay.textContent = `คะแนนสูงสุด: ${highScore}`;
            }
            
            // เอฟเฟกต์เกมโอเวอร์
            dino.style.transform = 'rotate(-30deg)';
        }
        
        // เริ่มเกมใหม่
        function startGame() {
            // รีเซ็ตตัวแปรเกม
            isGameOver = false;
            isGameStarted = true;
            score = 0;
            gameSpeed = 5;
            
            // ล้างกระบองเพชรทั้งหมด
            cacti.forEach(cactus => {
                gameContainer.removeChild(cactus.element);
            });
            cacti = [];
            
            // รีเซ็ตการแสดงผล
            scoreDisplay.textContent = '0';
            gameOverDisplay.style.display = 'none';
            startScreen.style.display = 'none';
            dino.style.bottom = '20px';
            dino.style.transform = 'rotate(0)';
            
            // เริ่มเกม
            updateGame();
        }
        
        // การควบคุม
        document.addEventListener('keydown', (event) => {
            if (event.code === 'Space' || event.key === 'ArrowUp') {
                event.preventDefault();
                if (isGameOver) {
                    startGame();
                } else {
                    jump();
                }
            }
        });
        
        // การควบคุมบนมือถือ
        gameContainer.addEventListener('click', () => {
            if (!isGameStarted) {
                startGame();
            } else if (isGameOver) {
                startGame();
            } else {
                jump();
            }
        });
        
        // ปุ่มเริ่มเกม
        startButton.addEventListener('click', startGame);
    </script>
</body>
</html>
